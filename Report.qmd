---
lang: pt  
title: "GED-16: Análise de Regressão"
subtitle: "AULA01: Prática (2o. semestre/2023)"
author: "Alexandre & Deodato & Pedro Igor"
date: "2023-08-01"  
format:
  html:
    theme: cosmo
execute:
  echo: true
  eval: true
  warning: false    
---

```{r include = FALSE}
library(tidyverse)
library(gridExtra)
library(lmtest)
library(MASS)
```

------------------------------------------------------------------------

### Introdução

Os dados disponíveis no arquivo `data/owid.csv` foram obtidos do portal [Our World in Data](https://ourworldindata.org/), cuja missão é publicar pesquisas e dados relacionados a grandes problemas mundiais como pobreza, doenças, fome, mudanças climáticas, guerras, riscos existenciais e desigualdade.

Os dados originais foram pré-processados no sentido de remover observações faltantes. Há um total de 985 observações coletadas para 21 variáveis:

1.  `continent`: continente em que está o país
2.  `entity`: nome do país
3.  `code`: código do país
4.  `year`: ano
5.  `birth_rate`: número de nascimentos com vida por 1.000 habitantes na população.
6.  `child_mortality`: mortes de crianças menores de 5 anos de idade (% nascimentos)
7.  `co2_emission_pc`: emissões anuais de CO2 per capita (t/pessoa)
8.  `deaths_solid_fuels_pollution`: mortes resultantes de poluição por queima de combustíveis sólidos em ambientes internos (/100K)
9.  `deaths_particulate_pollution`: mortes resultantes de poluição por material particulado em ambientes externos (/100K)
10. `deaths_air_pollution`: mortes resultantes de poluição do ar ambiente (/100K)
11. `deaths_ozone`: mortes resultantes de poluição por ozônio em ambientes externos (%)
12. `deaths_sanitation`: mortes resultantes de falta ou precariedade de acesso a saneamento básico (100K)
13. `electricity_demand`: geração total de eletricidade anual, ajustada por importação e exportação de eletricidade (TWh)
14. `energy_use_pc`: consumo de energia médio anual (eletricidade, transporte, aquecimento, preparo de alimentos) per capita (KWh/pessoa)
15. `expected_schooling`: expectativa do número de anos de educação que uma criança que entra no sistema escolar deve receber
16. `happiness_cantril_ladder`: nível de felicidade médio populacional (0-10)
17. `gdp_pc`: produto interno bruto per capita (\$ internacional, referência 2017)
18. `life_expectancy`: expectativa de vida no nascimento (anos)
19. `milk_consumption_pc`: consumo de leite médio anual per capita (kg)
20. `no_water`: população sem acesso a fontes seguras de água (encanada, poços, fontes, chuva e envasada) (%)
21. `urban_population_percent`: população habitante de áreas urbanas (% população total)

------------------------------------------------------------------------

### Análise Exploratória de Dados

Conduza a análise exploratória da massa de dados `owid`, a fim de compreender suas características principais.\
Voltaremos a utilizar essa massa de dados em atividades futuras.

```{r}
rm(list = ls())
owid <- read_delim("data/owid.csv", delim = ",", col_names = TRUE)
owid$continent <- as.factor(owid$continent)
summary(owid)
```

Note que para várias colunas há um intervalo muito grande entre o terceiro quartil e o valor máximo, o que pode indicar _outliers_ nos dados disponíveis. Semelhantemente para algumas colunas com `deaths_particulate_pollution`, `deaths_air_pollution` e `energy_use_pc` há um grande intervalo entre o valor mínimo e o primeiro quartil, indicando a exsitência de mais _outliers_.

#### Resumos gráficos de `life_expectancy`, possível variável de respota.

```{r}
ggplot(owid, aes(x = life_expectancy)) +
    geom_histogram(aes(y = after_stat(density))) +
    geom_density(lwd = 1, colour = 4,
                 fill = 4, alpha = 0.25) +
    geom_rug(alpha = 0.5) +
    labs(x = "Life Expectancy (years)", y = "Density")
```

O gráfico de densidade de _kernel_ ajuda a visualizar melhor os picos de espectativa de vida entre 70 e 80 anos, maior de todos e outros menores por volta dos 55, 65 e 85.

```{r}
ggplot(owid, aes(x = life_expectancy, y = "")) +
    geom_errorbar(stat = "boxplot", width = 0.1) +
    geom_boxplot () +
    geom_rug(alpha = 0.5) +
    labs(y = "", x = "Life Expectancy (years)")
```

#### Resumos gráficos multidimensionais

```{r}
ggplot(owid, aes(x = life_expectancy, y = continent)) +
  geom_errorbar(stat = "boxplot", width = 0.1) +
  geom_boxplot() +
  labs(x = "Life Expectancy (years)", y = "Continent")
```

```{r}
ggplot(owid, aes(y = life_expectancy, x = co2_emission_pc)) +
  geom_point(aes(color = continent)) +
  labs(y = "Life Expectancy (years)", x = "CO2 Emissions (tons/person)")
```

```{r}
ggplot(owid, aes(y = life_expectancy, x = electricity_demand)) +
geom_point() +
labs(x = "Eletricity Demand (TWh)", y = "Life Expectancy (years)")
```

```{r}
ggplot(owid, aes(y = life_expectancy, x = 1/electricity_demand)) +
geom_point() +
labs(x = "1/Ele(tricity Demand (1/TWh)", y = "Life Expectancy (years)")
```

```{r}
ggplot(owid, aes(y = life_expectancy, x = sqrt(electricity_demand))) +
geom_point() +
labs(x = "sqrt(Eletricity Demand)", y = "Life Expectancy (years)")
```


```{r}
ggplot(owid, aes(y = life_expectancy, x = log2(electricity_demand))) +
geom_point() +
labs(x = "Log2(Eletricity Demand)", y = "Life Expectancy (years)")
```

------------------------------------------------------------------------

### PARTE 1: Regressão Linear Simples


1. Assuma que um modelo de regressão linear simples é adequado para modelar a relação da variável de resposta `happiness_cantril_ladder` a cada uma das variáveis explicativas: `birth_rate`, `deaths_air_pollution`,`expected_schooling`, `life_expectancy`.

+ Construa um modelo de regressão para cada um desses pares de variáveis;

```{r}
br_rls <- lm(happiness_cantril_ladder ~ birth_rate, data = owid)
dap_rls <- lm(happiness_cantril_ladder ~ deaths_air_pollution, data = owid)
es_rls <- lm(happiness_cantril_ladder ~ expected_schooling, data = owid)
le_rls <- lm(happiness_cantril_ladder ~ life_expectancy, data = owid)
```

+ Construa gráficos de dispersão (separados) com as retas de regressão ajustadas para cada caso;

```{r}
ggplot(owid, aes(x = birth_rate, y = happiness_cantril_ladder)) +
  geom_point() +
  # adiciona reta de regressão estimada
  geom_smooth(method = lm, se = FALSE) + 
  labs(x = "Birth Rate (#/1K)", y = "Happiness Cantril Ladder")
```

```{r}
ggplot(owid, aes(x = deaths_air_pollution, y = happiness_cantril_ladder)) +
  geom_point() +
  # adiciona reta de regressão estimada
  geom_smooth(method = lm, se = FALSE) + 
  labs(x = "Deaths Air Pollution (#/100K)", y = "Happiness Cantril Ladder")
```

```{r}
ggplot(owid, aes(x = expected_schooling, y = happiness_cantril_ladder)) +
  geom_point() +
  # adiciona reta de regressão estimada
  geom_smooth(method = lm, se = FALSE) + 
  labs(x = "Expected Schoolling (years)", y = "Happiness Cantril Ladder")
```

```{r}
ggplot(owid, aes(x = life_expectancy, y = happiness_cantril_ladder)) +
  geom_point() +
  # adiciona reta de regressão estimada
  geom_smooth(method = lm, se = FALSE) + 
  labs(x = "Life Expectancy (years)", y = "Happiness Cantril Ladder")
```

+ Obtenha o MSE para cada modelo. Que variável explicativa produz menor variabilidade em torno da reta de regressão ajustada?

```{r}
summary(br_rls)$sigma^2
summary(dap_rls)$sigma^2
summary(es_rls)$sigma^2
summary(le_rls)$sigma^2
```

A variável explicativa `death_air_pollution` possuiu o menor valor de MSE, ou seja, produz menor variabilidade em torno da reta de regressão ajustada.

+ Utilizando R2 como critério, qual das variáveis explicativas contribui para a maior redução na variabilidade da resposta `happiness_cantril_ladder`?

```{r}
summary(br_rls)$r.squared
summary(dap_rls)$r.squared
summary(es_rls)$r.squared
summary(le_rls)$r.squared
```
A variável `death_air_pollution` também possuiu o maior valor para a estatística R2, assim ela contruibui para a maior redução da variabilidade da resposta.

2. Para cada nível da variável categórica `continent`, construa um modelo de regressão para a variável de resposta `happiness_cantril_ladder` em função da variável escolhida no último item da questão anterior.  Assuma que o modelo de 1a. ordem é adequado para modelar essas relações.

+ Obtenha os modelos de regressão ajustados. As funções de regressão estimadas são semelhantes para todos os níveis da variável `continent`? Discuta.

```{r}
# África
africa <- owid[owid$continent == "Africa",]
africa_rls <- lm(happiness_cantril_ladder ~ deaths_air_pollution, data = africa)

# Ásia
asia <- owid[owid$continent == "Asia",]
asia_rls <- lm(happiness_cantril_ladder ~ deaths_air_pollution, data = asia)

# Europa
europe <- owid[owid$continent == "Europe",]
europe_rls <- lm(happiness_cantril_ladder ~ deaths_air_pollution, data = europe)

# North America
north_america <- owid[owid$continent == "North America",]
north_america_rls <- lm(happiness_cantril_ladder ~ deaths_air_pollution, data = north_america)

# Oceania
oceania <- owid[owid$continent == "Oceania",]
oceania_rls <- lm(happiness_cantril_ladder ~ deaths_air_pollution, data = oceania)

# South America
south_america <- owid[owid$continent == "South America",]
south_america_rls <- lm(happiness_cantril_ladder ~ deaths_air_pollution, data = south_america)

```

```{r}
# Funcoes de regressao estimadas
africa_rls$coefficients
asia_rls$coefficients
europe_rls$coefficients
north_america_rls$coefficients
oceania_rls$coefficients
south_america_rls$coefficients
```

Com isso, nota-se que as funções de regressão estimadas são semelhantes para todos os níveis da variável `continent`, exceto para o continente `Oceania`, já que o valor do coeficiente angular é negativo para os demais continentes e positivo para o continente `Oceania`. Dentre os outros continentes nota-se que eles tem um coeficiente angular muito próximo, o que indica que a função de regressão estimada é semelhante para esses níveis da variável `continent`.

+ Obtenha o MSE para cada nível da variável `continent` A variabilidade em torno da reta de regressão ajustada é semelhante para todos os níveis?

```{r}
# África
summary(africa_rls)$sigma^2
# Ásia
summary(asia_rls)$sigma^2
# Europa
summary(europe_rls)$sigma^2
# North America
summary(north_america_rls)$sigma^2
# Oceania
summary(oceania_rls)$sigma^2
# South America
summary(south_america_rls)$sigma^2
```

Novamente temos uma diferença em relação ao continente `Oceania`, já que o valor do MSE é muito menor que os demais continentes. Dentre os outros continentes nota-se que eles tem um valor de MSE muito próximo, o que indica que a variabilidade em torno da reta de regressão ajustada é semelhante para esses níveis da variável `continent`, estando em uma mesma ordem de grandeza. Já o do continente `Oceania` é muito menor que os demais.

+ Construa intervalos de confiança 95% para o coeficiente angular da reta de regressão para os continentes `North America` e `South America`. As retas de regressão para os diferentes níveis parecem ter mesma inclinação? O que se pode concluir?

```{r}
# North America
confint(north_america_rls, level = 0.95)
# South America
confint(south_america_rls, level = 0.95)
```

Com uma confiança de 95%, nota-se que os intervalos de confiança não se interceptam, o que indica que as retas de regressão para os diferentes níveis não tem a mesma inclinação.

+ Construa intervalos de confiança para a resposta esperada correspondendo a `deaths_air_pollution` = 50, para os continentes `North America` e `South America` O que se pode concluir?

```{r}
# North America
predict(north_america_rls, newdata = data.frame(deaths_air_pollution = 50), interval = "confidence", level = 0.95)
# South America
predict(south_america_rls, newdata = data.frame(deaths_air_pollution = 50), interval = "confidence", level = 0.95)
```

Com uma confiança de 95%, nota-se que os intervalos de confiança não se interceptam, o que indica que as respostas esperadas para os continentes `North America` e `South America` não são iguais. Além disso, nota-se que o intervalo de confiança de ambos é pequeno, monstrando que a resposta esperada para `deaths_air_pollution` = 50 é bem próxima do valor estimado.

+ Construa intervalos de previsão para uma nova observação de cada continente (`North America` e `South America`) que tenha `deaths_air_pollution` = 50. O que se pode concluir?

```{r}
# Novo valor de deaths_air_pollution
new_x <- data.frame(deaths_air_pollution = 50)
# North America
predict(north_america_rls, newdata = new_x, interval = "prediction", level = 0.95)
# South America
predict(south_america_rls, newdata = new_x, interval = "prediction", level = 0.95)
```

Para uma nova observação de cada continente (`North America` e `South America`) que tenha `deaths_air_pollution` = 50, nota-se que os intervalos de previsão são muito mais dispersos que o anterior, mostrando que a previsão para uma nova observação é muito mais incerta que a resposta esperada para `deaths_air_pollution` = 50.

3. Construa um modelo de regressão para a variável de resposta `happiness_cantril_ladder` em função de `gdp_pc`. Assuma que o modelo de 1a. ordem é adequado para modelar essas relações. Faz sentido aplicar alguma transformação à variável explicativa? Replique os procedimentos realizados no  item (1) para um modelo considerando a variável explicativa em sua forma original ou transformada.

```{r}
# Analise de regressao para a variavel de resposta happiness_cantril_ladder em funcao de gdp_pc
gdp_rls <- lm(happiness_cantril_ladder ~ gdp_pc, data = owid)

ggplot(owid, aes(x = gdp_pc, y = happiness_cantril_ladder)) +
  geom_point() +
  # adiciona reta de regressão estimada
  geom_smooth(method = lm, se = FALSE) + 
  labs(x = "gdp_pc", y = "Happiness Cantril Ladder")
```

Com essa analise podemos perceber uma não linearidade em relação às variáveis `happiness_cantril_ladder` e `gdp_pc`, o que indica que o modelo de 1a. ordem não é adequado para modelar essas relações. Assim, faz sentido aplicar alguma transformação à variável explicativa.

```{r}
gdp_rls_inv = lm(happiness_cantril_ladder ~ 1/gdp_pc, data = owid)
ggplot(owid, aes(x = 1/gdp_pc, y = happiness_cantril_ladder)) +
  geom_point() +
  # adiciona reta de regressão estimada
  geom_smooth(method = lm, se = FALSE) + 
  labs(x = "1/gdp_pc", y = "Happiness Cantril Ladder")
gdp_rls_log = lm(happiness_cantril_ladder ~ log10(gdp_pc), data = owid)
ggplot(owid, aes(x = log10(gdp_pc) , y = happiness_cantril_ladder)) +
  geom_point() +
  # adiciona reta de regressão estimada
  geom_smooth(method = lm, se = FALSE) + 
  labs(x = "log(gdp_pc)", y = "Happiness Cantril Ladder")

```
Podemos observar que o modelo logaritmo parece ser uma relação mais adequada para modelar essas relações. Para mostrar isso vamos comprar o MSE e o R2 para cada uma das transformações.

```{r}
summary(gdp_rls)$sigma^2
summary(gdp_rls_inv)$sigma^2
summary(gdp_rls_log)$sigma^2

summary(gdp_rls)$r.squared
summary(gdp_rls_inv)$r.squared
summary(gdp_rls_log)$r.squared
```

Com esses parametros podemos perceber que o modelo logaritmo é o que apresenta o menor MSE e o maior R2, o que indica que ele é o mais adequado para modelar essas relações.

### Diagnóstico

1. Para cada um dos modelos de regressão ajustados no item (1) da seção anterior, realize o diagnóstico através da análise dos resíduos e apresente um resumo de suas conclusões. O modelo de regressão linear simples clássico de 1a. ordem é adequado a alguma das situações investigadas?

Inicialmente, vamos analisar o resumo do modelo de regressão ajustado

```{r}
summary(br_rls)
summary(dap_rls)
summary(es_rls)
summary(le_rls)
```

Agora vamos analisar os modelos por Linearidade, Homocedasticidade, Outliers, Independência e Normalidade.

##### Linearidade

+ Birth Rate

```{r}
br_rls_data <- owid %>%
  mutate(fitted = br_rls$fit) %>%
  mutate(resid = br_rls$res)

# Gera gráficos dos resíduos: 
ggplot(br_rls_data, aes(x = fitted, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("dados originais: modelo hcl ~ br") + 
  labs(y = "resíduos", x = "resposta ajustada (hcl)") 
ggplot(br_rls_data, aes(x = birth_rate, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("dados originais: modelo hcl ~ br") + 
  labs(y = "resíduos", x = "variável explicativa (br)")
```

+ Deaths Air Pollution

```{r}
dap_rls_data <- owid %>%
  mutate(fitted = dap_rls$fit) %>%
  mutate(resid = dap_rls$res)

# Gera gráficos dos resíduos:
ggplot(dap_rls_data, aes(x = fitted, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("dados originais: modelo hcl ~ dap") + 
  labs(y = "resíduos", x = "resposta ajustada (hcl)")
ggplot(dap_rls_data, aes(x = deaths_air_pollution, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("dados originais: modelo hcl ~ dap") + 
  labs(y = "resíduos", x = "variável explicativa (dap)")
```

+ Expected Schooling

```{r}
es_rls_data <- owid %>%
  mutate(fitted = es_rls$fit) %>%
  mutate(resid = es_rls$res)

# Gera gráficos dos resíduos:
ggplot(es_rls_data, aes(x = fitted, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("dados originais: modelo hcl ~ es") + 
  labs(y = "resíduos", x = "resposta ajustada (hcl)")
ggplot(es_rls_data, aes(x = expected_schooling, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("dados originais: modelo hcl ~ es") + 
  labs(y = "resíduos", x = "variável explicativa (es)")
```

+ Life Expectancy

```{r}
le_rls_data <- owid %>%
  mutate(fitted = le_rls$fit) %>%
  mutate(resid = le_rls$res)

# Gera gráficos dos resíduos:
ggplot(le_rls_data, aes(x = fitted, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("dados originais: modelo hcl ~ le") + 
  labs(y = "resíduos", x = "resposta ajustada (hcl)")
ggplot(le_rls_data, aes(x = life_expectancy, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("dados originais: modelo hcl ~ le") + 
  labs(y = "resíduos", x = "variável explicativa (le)")
```

##### Homocedasticidade

+ Birth Rate

```{r}
ggplot(br_rls_data, aes(x = fitted, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("dados originais: modelo hcl ~ br") +
  labs(y = "|resíduos|", x = "resposta ajustada (hcl)")
ggplot(br_rls_data, aes(x = birth_rate, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("dados originais: modelo hcl ~ br") +
  labs(y = "|resíduos|", x = "variável explicativa (br)")
```

Para concluir se há homocedasticidade, vamos realizar o teste de Breusch-Pagan.

```{r}
# Teste de Breusch-Pagan
bptest(br_rls, ~ birth_rate, data = owid)
```

O valor do p-valor é menor que 0.05, o que indica que há heterocedasticidade, ou seja, a variância dos resíduos não é constante.

+ Deaths Air Pollution

```{r}
ggplot(dap_rls_data, aes(x = fitted, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("dados originais: modelo hcl ~ dap") +
  labs(y = "|resíduos|", x = "resposta ajustada (hcl)")
ggplot(dap_rls_data, aes(x = deaths_air_pollution, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("dados originais: modelo hcl ~ dap") +
  labs(y = "|resíduos|", x = "variável explicativa (dap)")
```

Para concluir se há homocedasticidade, vamos realizar o teste de Breusch-Pagan.

```{r}
# Teste de Breusch-Pagan
bptest(dap_rls, ~ deaths_air_pollution, data = owid)
```

O valor do p-valor é maior que 0.05, o que indica que não há heterocedasticidade, ou seja, aceita-se a hipótese nula de que a variância dos resíduos é constante.

+ Expected Schooling

```{r}
ggplot(es_rls_data, aes(x = fitted, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("dados originais: modelo hcl ~ es") +
  labs(y = "|resíduos|", x = "resposta ajustada (hcl)")
ggplot(es_rls_data, aes(x = expected_schooling, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("dados originais: modelo hcl ~ es") +
  labs(y = "|resíduos|", x = "variável explicativa (es)")
```

Para concluir se há homocedasticidade, vamos realizar o teste de Breusch-Pagan.

```{r}
# Teste de Breusch-Pagan
bptest(es_rls, ~ expected_schooling, data = owid)
```

O valor do p-valor foi bem maior que 0.05, o que indica que não há heterocedasticidade, ou seja, aceita-se a hipótese nula de que a variância dos resíduos é constante.

+ Life Expectancy

```{r}
ggplot(le_rls_data, aes(x = fitted, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("dados originais: modelo hcl ~ le") +
  labs(y = "|resíduos|", x = "resposta ajustada (hcl)")
ggplot(le_rls_data, aes(x = life_expectancy, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("dados originais: modelo hcl ~ le") +
  labs(y = "|resíduos|", x = "variável explicativa (le)")
```

Para concluir se há homocedasticidade, vamos realizar o teste de Breusch-Pagan.

```{r}
# Teste de Breusch-Pagan
bptest(le_rls, ~ life_expectancy, data = owid)
```

O valor do p-valor foi bem maior que 0.05, o que indica que não há heterocedasticidade, ou seja, aceita-se a hipótese nula de que a variância dos resíduos é constante.

##### Outliers

Para identificar os outliers é importante utilizar os resíduos semi-studentizados, que são os resíduos divididos pelo desvio padrão dos resíduos. Assim, vamos analisar os gráficos dos resíduos semi-studentizados.

+ Birth Rate

```{r}
# criar nova coluna para os residuos semi-studentizados
br_rls_data <- br_rls_data %>%
  mutate(resid_ss = rstandard(br_rls))

# Gera gráficos dos resíduos semi-studentizados:
ggplot(br_rls_data, aes(x = fitted, y = resid_ss)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("dados transformados: modelo hcl ~ br") +
  labs(y = "resíduos padronizados", x = "resposta ajustada (hcl)")
ggplot(br_rls_data, aes(x = birth_rate, y = resid_ss)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("dados transformados: modelo hcl ~ br") +
  labs(y = "resíduos padronizados", x = "variável explicativa (br)")
```

Nota-se que temos alguns pontos com módulo do resíduo semi-studentizado próximos a 3, o que pode indicar a existência de outliers mas a evidência é fraca e não se deve realizar a exclusão de nenhum ponto por enquanto.

+ Deaths Air Pollution

```{r}
# criar nova coluna para os residuos semi-studentizados
dap_rls_data <- dap_rls_data %>%
  mutate(resid_ss = rstandard(dap_rls))

# Gera gráficos dos resíduos semi-studentizados:
ggplot(dap_rls_data, aes(x = fitted, y = resid_ss)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("dados transformados: modelo hcl ~ dap") +
  labs(y = "resíduos padronizados", x = "resposta ajustada (hcl)")
ggplot(dap_rls_data, aes(x = deaths_air_pollution, y = resid_ss)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("dados transformados: modelo hcl ~ dap") +
  labs(y = "resíduos padronizados", x = "variável explicativa (dap)")
```

Nota-se em ambos os gráficos a existência de pontos de resíduos semi-studentizados maiores que 3, indicando uma forte possibilidade de outliers. Assim, é mais recomendade nesse caso excluir esses pontos.

+ Expected Schooling

```{r}
# criar nova coluna para os residuos semi-studentizados
es_rls_data <- es_rls_data %>%
  mutate(resid_ss = rstandard(es_rls))

# Gera gráficos dos resíduos semi-studentizados:
ggplot(es_rls_data, aes(x = fitted, y = resid_ss)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("dados transformados: modelo hcl ~ es") +
  labs(y = "resíduos padronizados", x = "resposta ajustada (hcl)")
ggplot(es_rls_data, aes(x = expected_schooling, y = resid_ss)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("dados transformados: modelo hcl ~ es") +
  labs(y = "resíduos padronizados", x = "variável explicativa (es)")
```

Alguns pontos se aproximam de 3, mas não o suficiente para indicar a existência de outliers.

+ Life Expectancy

```{r}
# criar nova coluna para os residuos semi-studentizados
le_rls_data <- le_rls_data %>%
  mutate(resid_ss = rstandard(le_rls))

# Gera gráficos dos resíduos semi-studentizados:
ggplot(le_rls_data, aes(x = fitted, y = resid_ss)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("dados transformados: modelo hcl ~ le") +
  labs(y = "resíduos padronizados", x = "resposta ajustada (hcl)")
ggplot(le_rls_data, aes(x = life_expectancy, y = resid_ss)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("dados transformados: modelo hcl ~ le") +
  labs(y = "resíduos padronizados", x = "variável explicativa (le)")
```

Temos novamente alguns pontos com módulo do resíduo semi-studentizado próximos a 3, o que pode indicar a existência de outliers mas a evidência é fraca e não se deve realizar a exclusão de nenhum ponto por enquanto.

##### Independência

Para a independência iremos utilizar o teste de Durbin-Watson.

+ Birth Rate

```{r}
# Teste de Durbin-Watson
dwtest(br_rls, ~ birth_rate, data = owid)
```

O p-valor é bem menor que 0.05, o que indica que há autocorrelação positiva, ou seja, a hipótse nula de que não há autocorrelação positiva é rejeitada.

+ Deaths Air Pollution

```{r}
# Teste de Durbin-Watson
dwtest(dap_rls, ~ deaths_air_pollution, data = owid)
```

O p-valor é bem menor que 0.05, o que indica que há autocorrelação positiva, ou seja, a hipótse nula de que não há autocorrelação positiva é rejeitada.

+ Expected Schooling

```{r}
# Teste de Durbin-Watson
dwtest(es_rls, ~ expected_schooling, data = owid)
```

O p-valor é bem menor que 0.05, o que indica que há autocorrelação positiva, ou seja, a hipótse nula de que não há autocorrelação positiva é rejeitada.

+ Life Expectancy

```{r}
# Teste de Durbin-Watson
dwtest(le_rls, ~ life_expectancy, data = owid)
```

O p-valor é bem menor que 0.05, o que indica que há autocorrelação positiva, ou seja, a hipótse nula de que não há autocorrelação positiva é rejeitada.

##### Normalidade

Para a normalidade iremos utilizar o teste de Shapiro-Wilk. E gráficamente iremos utilizar o gráfico de probabilidade normal.

+ Birth Rate

```{r}
# Teste de Shapiro-Wilk
shapiro.test(br_rls$res)
```

O p-valor é bem menor que 0.05, o que indica que não há normalidade, ou seja, a hipótse nula de que há normalidade é rejeitada. Assim, concluimos que os erros não são normalmente distribuídos.

Para complementar, analisaremo o gráfico de probabilidade normal.

```{r}
# Gráfico de probabilidade normal
qqnorm(br_rls$res)
qqline(br_rls$res)
```

E também o histograma dos resíduos.

```{r}
# Histograma dos resíduos
ggplot(br_rls_data, aes(x = resid)) +
  geom_histogram(bins = 20) +
  ggtitle("dados originais: modelo hcl ~ br") +
  labs(y = "frequência", x = "resíduos")
```

+ Deaths Air Pollution

```{r}
# Teste de Shapiro-Wilk
shapiro.test(dap_rls$res)
```

O p-valor é menor que 0.05, o que indica que não há normalidade, ou seja, a hipótse nula de que há normalidade é rejeitada. Assim, concluimos que os erros não são normalmente distribuídos.

Para complementar, analisaremo o gráfico de probabilidade normal.

```{r}
# Gráfico de probabilidade normal
qqnorm(dap_rls$res)
qqline(dap_rls$res)
```

E também o histograma dos resíduos.

```{r}
# Histograma dos resíduos
ggplot(dap_rls_data, aes(x = resid)) +
  geom_histogram(bins = 20) +
  ggtitle("dados originais: modelo hcl ~ dap") +
  labs(y = "frequência", x = "resíduos")
```

+ Expected Schooling

```{r}
# Teste de Shapiro-Wilk
shapiro.test(es_rls$res)
```

O p-valor é menor que 0.05, o que indica que não há normalidade, ou seja, a hipótse nula de que há normalidade é rejeitada. Assim, concluimos que os erros não são normalmente distribuídos.

Para complementar, analisaremo o gráfico de probabilidade normal.

```{r}
# Gráfico de probabilidade normal
qqnorm(es_rls$res)
qqline(es_rls$res)
```

E também o histograma dos resíduos.

```{r}
# Histograma dos resíduos
ggplot(es_rls_data, aes(x = resid)) +
  geom_histogram(bins = 20) +
  ggtitle("dados originais: modelo hcl ~ es") +
  labs(y = "frequência", x = "resíduos")
```

+ Life Expectancy

```{r}
# Teste de Shapiro-Wilk
shapiro.test(le_rls$res)
```

O p-valor é bem menor que 0.05, o que indica que não há normalidade, ou seja, a hipótse nula de que há normalidade é rejeitada. Assim, concluimos que os erros não são normalmente distribuídos.

Para complementar, analisaremo o gráfico de probabilidade normal.

```{r}
# Gráfico de probabilidade normal
qqnorm(le_rls$res)
qqline(le_rls$res)
```

E também o histograma dos resíduos.

```{r}
# Histograma dos resíduos
ggplot(le_rls_data, aes(x = resid)) +
  geom_histogram(bins = 20) +
  ggtitle("dados originais: modelo hcl ~ le") +
  labs(y = "frequência", x = "resíduos")
```

##### Conclusão

Com os dados analisados podemos concluir que o modelo de regressão linear simples clássico de 1a. ordem não é adequado para modelar essas relações, pois não atende a todas as hipóteses necessárias para sua aplicação.

O modelo do `Deaths Air Pollution` é o que mais se aproxima de um modelo de regressão linear simples clássico de 1a. ordem, pois atende a todas as hipóteses necessárias para sua aplicação, exceto a normalidade dos erros e da independência dos erros, mas esses desvios podem ser explicados pela existência de outliers. 

2. Ajuste um modelo de regressão linear simples para a variável `happiness_cantril_ladder` como função de `deaths_air_pollution` após excluir as observações 973 (X = 237 e Y = 6.00), 974 (X = 234 e Y = 5.99) e 975 (X = 225 e Y = 5.97). Obtenha intervalos de previsão de 95% de confiança para novas observações que apresentam valores da variável explicativa iguais a 237, 234 e 225. As observações eliminadas encontram-se nos limites dos intervalos de previsão obtidos? Discuta o significado dos resultados obtidos.

inicialmente precisamos excluir as observações 973, 974 e 975.

```{r}
# Excluindo as observações
hcl_dap <- lm(happiness_cantril_ladder ~ deaths_air_pollution, data = slice(owid,-c(973, 974, 975)))

# Intervalos de previsão
predict(hcl_dap, newdata = data.frame(deaths_air_pollution = c(237, 234, 225)), interval = "prediction", level = 0.95)

```	

Podemos perceber que em um intervalo de confiança de 95% as observações 973, 974 e 975 não estão nos limites dos intervalos de previsão. O que é um indício de que essas observações são outliers.

3. Para os modelos considerando cada nível da variável `continent` no item (2) da seção anterior, realize o diagnóstico através da análise dos resíduos. Todos aparentam ter mesma variância dos erros? É necessário realizar alguma transformação de variáveis? Tente solucionar os possíveis problemas encontrados com o modelo. Que conclusões é possível obter a partir da análise?

+ África

##### Linearidade

```{r}
africa_rls_data <- africa %>%
  mutate(fitted = africa_rls$fit) %>%
  mutate(resid = africa_rls$res)

# Gráficos dos resíduos: 
ggplot(africa_rls_data, aes(x = fitted, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "resíduos", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(africa_rls_data, aes(x = deaths_air_pollution, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "resíduos", x = "variável explicativa (Deaths Air Pollution)") 
```

Não há nenhuma tendência não-linear nítida para ambos os gráficos, dessa forma, com as informações disponíveis, não há violação da hipótese de lineariedade.

##### Homoscedasticidade
```{r}
ggplot(africa_rls_data, aes(x = fitted, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "|resíduos|", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(africa_rls_data, aes(x = deaths_air_pollution, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "|resíduos|", x = "variável explicativa (Deaths Air Pollution)") 
```

```{r}
bptest(africa_rls, ~ deaths_air_pollution, data = africa)
```

Não parece haver mudança da variância com os valores da resposta ajustada e variável explicativa.
Há mais pontos para os valores centrais de ambas as variáveis, mas desconsiderando esse volume adicional há nenhuma mudança com mudança.
Por fim, o teste de Breusch-Pagan retornou um valor p alto, por tanto, não é possível rejeitar a hipótese nula, ou seja, não há ocorrência dessa violação.

##### Outliers
```{r}
africa_rls_data <- africa_rls_data %>%
  # resíduos padronizados
  mutate(resid_pad = rstandard(africa_rls))

# Gera gráficos dos resíduos padronizados:
ggplot(africa_rls_data, aes(x = fitted, y = resid_pad)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("modelo happiness ~ air pollution") +
  labs(y = "resíduos padronizados", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(africa_rls_data, aes(x = deaths_air_pollution, y = resid_pad)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("modelo happiness ~ air pollution") +
  labs(y = "resíduos padronizados", x = "variável explicativa (Deaths Air Pollution)") 
```

Analisando ambos os gráficos, não há a presença de pontos extremos (acima de 3 $\sigma$).

##### Independênica

```{r}
dwtest(africa_rls, ~ deaths_air_pollution, data = africa)
```

O valor p do teste de Durbin-Watson nos leva a rejeitar a hipótese nula e que há correlação não nula entre os erros.

##### Normalidade

```{r}
ggplot(africa_rls_data, aes(sample = resid_pad)) +
  stat_qq() + stat_qq_line() + 
  labs(y = "quantis amostrais", x = "quantis teóricos (dist. normal)") 

shapiro.test(africa_rls$res)
```

Observando o gráfico de quantis normais vê-se que os dados não são exatamente normais.
O teste de Shapiro-Wilk também nos leva a rejeitar a hipótese nula, mas o valor não é extremamente pequeno, não é uma violação tão grave da normalidade.

##### Medidas Corretivas
```{r}
bc <- boxcox(lm(happiness_cantril_ladder ~ deaths_air_pollution, data = africa_rls_data), 
             lambda = seq(-2, 2, by = 0.1), plotit = TRUE)
lambda <- bc$x[which.max(bc$y)]
```

O valor de $\lambda$ que maximiza a função de verossemelhança vale `r round(lambda, digits = 2)` que está mais próximo de 1, ou seja, a transformção Box-Cox sugere manter o modelo como está.

+ Ásia

##### Linearidade

```{r}
asia_rls_data <- asia %>%
  mutate(fitted = asia_rls$fit) %>%
  mutate(resid = asia_rls$res)

# Gráficos dos resíduos: 
ggplot(asia_rls_data, aes(x = fitted, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "resíduos", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(asia_rls_data, aes(x = deaths_air_pollution, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "resíduos", x = "variável explicativa (Deaths Air Pollution)") 
```

Analisando ambos os gráficos também não é possível encontrar tendências de não-linearidade, os resíduos se comportam como resíduo branco.

##### Homoscedasticidade
```{r}
ggplot(asia_rls_data, aes(x = fitted, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "|resíduos|", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(asia_rls_data, aes(x = deaths_air_pollution, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "|resíduos|", x = "variável explicativa (Deaths Air Pollution)") 
```

```{r}
bptest(asia_rls, ~ deaths_air_pollution, data = asia)
```

Há, também, uma aparenete não constancia da variabilidade, mas isso pode estar relacionado a disponibilidade dos dados, isto é, não há uma quantidade semelhante para todos os intervalos.

Além disso, o valor p do teste de Breush-Pagan também nos indica para não rejeitar a hipótese nula, logo não há violação da homoscedasticidade.

##### Outliers
```{r}
asia_rls_data <- asia_rls_data %>%
  # resíduos padronizados
  mutate(resid_pad = rstandard(asia_rls))

# Gera gráficos dos resíduos padronizados:
ggplot(asia_rls_data, aes(x = fitted, y = resid_pad)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("modelo happiness ~ air pollution") +
  labs(y = "resíduos padronizados", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(asia_rls_data, aes(x = deaths_air_pollution, y = resid_pad)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("modelo happiness ~ air pollution") +
  labs(y = "resíduos padronizados", x = "variável explicativa (Deaths Air Pollution)") 
```

Ambos os gráficos, não há presença de pontos extremos (acima de 3 $\sigma$).

##### Independênica

```{r}
dwtest(asia_rls, ~ deaths_air_pollution, data = asia)
```

O valor do teste de Durbin-Watson é muito pequeno, o que nos leva a rejeitar a hipótese nula, ou seja, há correção entre os erros. Possivelmente poderia acrescentar outras variáveis explicativas para solucionar esse problema, mas foge ao escopo das análises.

##### Normalidade

```{r}
ggplot(asia_rls_data, aes(sample = resid_pad)) +
  stat_qq() + stat_qq_line() + 
  labs(y = "quantis amostrais", x = "quantis teóricos (dist. normal)") 

shapiro.test(asia_rls$res)
```

A análise do gráfico de quantis sugere que a distribuição possui uma cauda mais longa à direita.
O valor p do teste de Shapiro-Wilk também nos leva a rejeitar a hipótese nula e considerar os dados não distribuidos normalmente.

##### Medidas Corretivas
```{r}
bc <- boxcox(lm(happiness_cantril_ladder ~ deaths_air_pollution, data = asia_rls_data), 
             lambda = seq(-2, 2, by = 0.1), plotit = TRUE)
lambda <- bc$x[which.max(bc$y)]
```
O valor de $\lambda$ que maximiza a função de verossemelhança vale `r round(lambda, digits = 2)` que está mais próximo de 0.5, o que indica uma transformação $\sqrt{Y}$ deve ser aplicada. As verificações serão replicadas para analisar o novo modelo.

```{r}
asia_rls_bc_data <-  asia_rls_data %>%
  mutate(happiness_bc = sqrt(happiness_cantril_ladder))

asia_rls_bc <- lm(happiness_bc ~ deaths_air_pollution, data = asia_rls_bc_data)

summary(asia_rls_bc)
```

###### Linearidade

```{r}
asia_rls_bc_data <- asia_rls_bc_data %>%
  mutate(fitted = asia_rls_bc$fit) %>%
  mutate(resid = asia_rls_bc$res)

# Gráficos dos resíduos: 
ggplot(asia_rls_bc_data, aes(x = fitted, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "resíduos", x = "resposta ajustada (sqrt(Happiness Cantril Ladder))") 
ggplot(asia_rls_bc_data, aes(x = deaths_air_pollution, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "resíduos", x = "variável explicativa (Deaths Air Pollution)") 
```

Não parece haver sinais de não-linearidade com a transformação Box-Cox.

###### Homoscedasticidade
```{r}
ggplot(asia_rls_bc_data, aes(x = fitted, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "|resíduos|", x = "resposta ajustada (sqrt(Happiness Cantril Ladder))") 
ggplot(asia_rls_bc_data, aes(x = deaths_air_pollution, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "|resíduos|", x = "variável explicativa (Deaths Air Pollution)") 
```

```{r}
bptest(asia_rls_bc, ~ deaths_air_pollution, data = asia_rls_bc_data)
```

Pelo valor p do teste de Breusch-Pagan é a possível rejeitar a hipótese nula, ou seja, há hetescedasticidade com a tranformação.
Dessa forma, há sinais que essa transformação não seja útil.

###### Outliers
```{r}
asia_rls_bc_data <- asia_rls_bc_data %>%
  # resíduos padronizados
  mutate(resid_pad = rstandard(asia_rls_bc))

# Gera gráficos dos resíduos padronizados:
ggplot(asia_rls_bc_data, aes(x = fitted, y = resid_pad)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("modelo happiness ~ air pollution") +
  labs(y = "resíduos padronizados", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(asia_rls_bc_data, aes(x = deaths_air_pollution, y = resid_pad)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("modelo happiness ~ air pollution") +
  labs(y = "resíduos padronizados", x = "variável explicativa (Deaths Air Pollution)") 
```

Há a presenção de outliers com a tranformação, mas apenas um ponto ultrapassa os 3$\sigma$, o que não impactante para o modelo.

###### Independênica

```{r}
dwtest(asia_rls_bc, ~ deaths_air_pollution, data = asia_rls_bc_data)
```

O valor p do teste de Durbin-Watson ainda é muito baixo, ou seja, ainda há correlação.

###### Normalidade

```{r}
ggplot(asia_rls_bc_data, aes(sample = resid_pad)) +
  stat_qq() + stat_qq_line() + 
  labs(y = "quantis amostrais", x = "quantis teóricos (dist. normal)") 

shapiro.test(asia_rls_bc$res)
```

O valor p do teste de Shapiro-Wilk ainda é baixo, ou seja, a transformação não foi útil para melhorar o modelo.


------------------------------------------------------------------------


+ Europa

##### Linearidade

```{r}
europe_rls_data <- europe %>%
  mutate(fitted = europe_rls$fit) %>%
  mutate(resid = europe_rls$res)

# Gráficos dos resíduos: 
ggplot(europe_rls_data, aes(x = fitted, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "resíduos", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(europe_rls_data, aes(x = deaths_air_pollution, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "resíduos", x = "variável explicativa (Deaths Air Pollution)") 
```

Há muitas observações nos extremos direto da resposta ajustada e exquero da variável explicativa, isso leva a acreditar que há uma tendência não linear ou não constância da variância do erro, mas não parece ser o caso.

##### Homoscedasticidade
```{r}
ggplot(europe_rls_data, aes(x = fitted, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "|resíduos|", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(europe_rls_data, aes(x = deaths_air_pollution, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "|resíduos|", x = "variável explicativa (Deaths Air Pollution)") 
```

```{r}
bptest(europe_rls, ~ deaths_air_pollution, data = europe)
```

O valor p do teste de Breush-Pagan nos leva a não rejetar a hipótese nula, ou seja, não há violação da homoscedasticidade

##### Outliers
```{r}
europe_rls_data <- europe_rls_data %>%
  # resíduos padronizados
  mutate(resid_pad = rstandard(europe_rls))

# Gera gráficos dos resíduos padronizados:
ggplot(europe_rls_data, aes(x = fitted, y = resid_pad)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("modelo happiness ~ air pollution") +
  labs(y = "resíduos padronizados", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(europe_rls_data, aes(x = deaths_air_pollution, y = resid_pad)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("modelo happiness ~ air pollution") +
  labs(y = "resíduos padronizados", x = "variável explicativa (Deaths Air Pollution)") 
```

Ambos os gráficos, não há presença de pontos extremos (acima de 3 $\sigma$).

##### Independênica

```{r}
dwtest(europe_rls, ~ deaths_air_pollution, data = europe)
```

Assim como os demais continentes, o valor p do teste de Durbin-Watson nos leva a rejeitar a hipótese nula e acreditar que há uma violação da independência dos erros.

##### Normalidade

```{r}
ggplot(europe_rls_data, aes(sample = resid_pad)) +
  stat_qq() + stat_qq_line() + 
  labs(y = "quantis amostrais", x = "quantis teóricos (dist. normal)") 

shapiro.test(europe_rls$res)
```

O gráfico dos quantis nos leva a acreditar numa fuga da normalidade na causa direita, a qual é mais curta do que esperado.
O valor p do teste de Shapiro-Wilk nos leva a rejeitar a hipótese nula, ou seja, há problemas de normalidade.

##### Medidas Corretivas
```{r}
bc <- boxcox(lm(happiness_cantril_ladder ~ deaths_air_pollution, data = europe_rls_data), 
             lambda = seq(-2, 2, by = 0.1), plotit = TRUE)
lambda <- bc$x[which.max(bc$y)]
```
O valor de $\lambda$ que maximiza a função de verossemelhança vale `r round(lambda, digits = 2)` que está no meio entre 0.5 e 1.0, por simplicidade aproximaremos para 1, mas é possível também analisar a qualidade do modelo considerando $\lambda = 0.5$.

+ América do Norte

##### Linearidade

```{r}
north_america_rls_data <- north_america %>%
  mutate(fitted = north_america_rls$fit) %>%
  mutate(resid = north_america_rls$res)

# Gráficos dos resíduos: 
ggplot(north_america_rls_data, aes(x = fitted, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "resíduos", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(north_america_rls_data, aes(x = deaths_air_pollution, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "resíduos", x = "variável explicativa (Deaths Air Pollution)") 
```

A pesar da falta de dados, não é possível identificar qualquer tendência nos gráficos de resíduos, logo não há violação da lineariedade analisando apenas os gráficos dos resíduos.

##### Homoscedasticidade
```{r}
ggplot(north_america_rls_data, aes(x = fitted, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "|resíduos|", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(north_america_rls_data, aes(x = deaths_air_pollution, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "|resíduos|", x = "variável explicativa (Deaths Air Pollution)") 
```

```{r}
bptest(north_america_rls, ~ deaths_air_pollution, data = north_america)
```

O valor p do teste de Breush-Pagan nos leva a não rejetar a hipótese nula, ou seja, não há violação da homoscedasticidade

##### Outliers
```{r}
north_america_rls_data <- north_america_rls_data %>%
  # resíduos padronizados
  mutate(resid_pad = rstandard(north_america_rls))

# Gera gráficos dos resíduos padronizados:
ggplot(north_america_rls_data, aes(x = fitted, y = resid_pad)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("modelo happiness ~ air pollution") +
  labs(y = "resíduos padronizados", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(north_america_rls_data, aes(x = deaths_air_pollution, y = resid_pad)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("modelo happiness ~ air pollution") +
  labs(y = "resíduos padronizados", x = "variável explicativa (Deaths Air Pollution)") 
```

Ambos os gráficos, não há presença de pontos extremos (acima de 3 $\sigma$).

##### Independênica

```{r}
dwtest(north_america_rls, ~ deaths_air_pollution, data = north_america)
```

Assim como os demais continentes, o valor p do teste de Durbin-Watson nos leva a rejeitar a hipótese nula e acreditar que há uma violação da independência dos erros.

##### Normalidade

```{r}
ggplot(north_america_rls_data, aes(sample = resid_pad)) +
  stat_qq() + stat_qq_line() + 
  labs(y = "quantis amostrais", x = "quantis teóricos (dist. normal)") 

shapiro.test(north_america_rls$res)
```

Os pontos no gráfico dos quantis não estão perfeitamente dispostos na curva, mas com o valor p do teste de Shapiro-Wilk não é possível rejeitar a hipótese nula. Dessa forma, pode acreditar que os dados estão normalmente distribuidos.


+ América do Sul

##### Linearidade

```{r}
south_america_rls_data <- south_america %>%
  mutate(fitted = south_america_rls$fit) %>%
  mutate(resid = south_america_rls$res)

# Gráficos dos resíduos: 
ggplot(south_america_rls_data, aes(x = fitted, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "resíduos", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(south_america_rls_data, aes(x = deaths_air_pollution, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "resíduos", x = "variável explicativa (Deaths Air Pollution)") 
```

Não é possível visualizar tão bem os gráfico devido a quantidade de dados presentes, mas há uma certeza tendência parabólica para a américa do sul. Isso nos leva a acreditar que há uma violação da lineariedade.

##### Homoscedasticidade
```{r}
ggplot(south_america_rls_data, aes(x = fitted, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "|resíduos|", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(south_america_rls_data, aes(x = deaths_air_pollution, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "|resíduos|", x = "variável explicativa (Deaths Air Pollution)") 
```

```{r}
bptest(south_america_rls, ~ deaths_air_pollution, data = south_america)
```

O valor p do teste de Breush-Pagan nos leva a não rejetar a hipótese nula, ou seja, não há violação da homoscedasticidade

##### Outliers
```{r}
south_america_rls_data <- south_america_rls_data %>%
  # resíduos padronizados
  mutate(resid_pad = rstandard(south_america_rls))

# Gera gráficos dos resíduos padronizados:
ggplot(south_america_rls_data, aes(x = fitted, y = resid_pad)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("modelo happiness ~ air pollution") +
  labs(y = "resíduos padronizados", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(south_america_rls_data, aes(x = deaths_air_pollution, y = resid_pad)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("modelo happiness ~ air pollution") +
  labs(y = "resíduos padronizados", x = "variável explicativa (Deaths Air Pollution)") 
```

Ambos os gráficos, não há presença de pontos extremos (acima de 3 $\sigma$).

##### Independênica

```{r}
dwtest(south_america_rls, ~ deaths_air_pollution, data = south_america)
```

Assim como os demais continentes, o valor p do teste de Durbin-Watson nos leva a rejeitar a hipótese nula e acreditar que há uma violação da independência dos erros.

##### Normalidade

```{r}
ggplot(south_america_rls_data, aes(sample = resid_pad)) +
  stat_qq() + stat_qq_line() + 
  labs(y = "quantis amostrais", x = "quantis teóricos (dist. normal)") 

shapiro.test(south_america_rls$res)
```

Os pontos no gráfico dos quantis não estão perfeitamente dispostos na curva, mas com o valor p do teste de Shapiro-Wilk não é possível rejeitar a hipótese nula. Dessa forma, pode acreditar que os dados estão normalmente distribuidos.

##### Medidas Corretivas
```{r}
bc <- boxcox(lm(happiness_cantril_ladder ~ deaths_air_pollution, data = south_america_rls_data), 
             lambda = seq(-2, 2, by = 0.1), plotit = TRUE)
lambda <- bc$x[which.max(bc$y)]
```
O valor de $\lambda$ que maximiza a função de verossemelhança vale `r round(lambda, digits = 2)` que está mais perto de 0.5, assim a tranformação $\sqrt{Y}$ foi indicada pelo método Box-Cox.

+ Oceania

##### Linearidade

```{r}
oceania_rls_data <- oceania %>%
  mutate(fitted = oceania_rls$fit) %>%
  mutate(resid = oceania_rls$res)

# Gráficos dos resíduos: 
ggplot(oceania_rls_data, aes(x = fitted, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "resíduos", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(oceania_rls_data, aes(x = deaths_air_pollution, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "resíduos", x = "variável explicativa (Deaths Air Pollution)") 
```

Há poucos dados para a Oceania, prejudicando muito as análises dos gráficos, devido à falta de informações. Além disso, como há poucos dados o modelo está muito mais suscetível a overfitting.

##### Homoscedasticidade
```{r}
ggplot(oceania_rls_data, aes(x = fitted, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "|resíduos|", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(oceania_rls_data, aes(x = deaths_air_pollution, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(y = "|resíduos|", x = "variável explicativa (Deaths Air Pollution)") 
```

```{r}
bptest(oceania_rls, ~ deaths_air_pollution, data = oceania)
```

O valor p do teste de Breush-Pagan nos leva a não rejetar a hipótese nula, ou seja, não há violação da homoscedasticidade

##### Outliers
```{r}
oceania_rls_data <- oceania_rls_data %>%
  # resíduos padronizados
  mutate(resid_pad = rstandard(oceania_rls))

# Gera gráficos dos resíduos padronizados:
ggplot(oceania_rls_data, aes(x = fitted, y = resid_pad)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("modelo happiness ~ air pollution") +
  labs(y = "resíduos padronizados", x = "resposta ajustada (Happiness Cantril Ladder)") 
ggplot(oceania_rls_data, aes(x = deaths_air_pollution, y = resid_pad)) +
  geom_point() +
  geom_hline(yintercept = c(-4, -3, 0, 3, 4), 
             linetype = "dashed", 
             color = c("red", "orange", "black", "orange", "red") ) +
  ylim(-6, 6) +
  ggtitle("modelo happiness ~ air pollution") +
  labs(y = "resíduos padronizados", x = "variável explicativa (Deaths Air Pollution)") 
```

Ambos os gráficos, não há presença de pontos extremos (acima de 3 $\sigma$).

##### Independênica

```{r}
dwtest(oceania_rls, ~ deaths_air_pollution, data = oceania)
```

Assim como os demais continentes, o valor p do teste de Durbin-Watson nos leva a rejeitar a hipótese nula e acreditar que há uma violação da independência dos erros.

##### Normalidade

```{r}
ggplot(oceania_rls_data, aes(sample = resid_pad)) +
  stat_qq() + stat_qq_line() + 
  labs(y = "quantis amostrais", x = "quantis teóricos (dist. normal)") 

shapiro.test(oceania_rls$res)
```


##### Medidas Corretivas
```{r}
bc <- boxcox(lm(happiness_cantril_ladder ~ deaths_air_pollution, data = oceania_rls_data), 
             lambda = seq(-2, 2, by = 0.1), plotit = TRUE)
lambda <- bc$x[which.max(bc$y)]
```
O valor de $\lambda$ que maximiza a função de verossemelhança vale `r round(lambda, digits = 2)` então a transformação sugerida pelo método é $Y^2$.

### PARTE 2: Regressão Linear Múltipla

Dois modelos foram propostos para prever o a expectativa de vida de um país (`life_expectancy`):

**Modelo I:** utiliza como variáveis explicativas `birth_rate`, `expected_schooling` e `milk_consumption_pc`.

**Modelo II:** utiliza como variáveis explicativas `log(gdp_pc)`, `no_water` e `urban_population_percent`.

1. Construa a matriz de gráficos de dispersão, bem como a matriz de correlação para cada modelo proposto. Interprete os resultados obtidos.

```{r}
m1 <- lm(life_expectancy ~ birth_rate + expected_schooling + milk_consumption_pc, data = owid)
m2 <- lm(life_expectancy ~ log(gdp_pc) + no_water + urban_population_percent, data = owid)
```

```{r}
selected_columns <- c("life_expectancy", "birth_rate", "expected_schooling", "milk_consumption_pc")
plot(owid[selected_columns])
cor(owid[selected_columns])
```

Há correlação relativamente alta entre `birth_rate` e `expected_schooling` 0.81, em módulo. Os valores de correção entre `birth_rate` e `milk_consumption_pc` não é tão alto (0.58), o mesmo vale para `expected_schooling` e `milk_consumption_pc` (0.63). Além disso, as variáveis explicativas `birth_rate` e `expected_schooling` possuem as maiores correlações com a varável de resposta `life_expectancy`, enquanto `milk_consumption_pc` não possui uma correção tão grande. O mesmo pode ser visto graficamente como a matriz de gráficos de dispersão.

```{r}
owid$log_gpd_pc <- log(owid$gdp_pc)
selected_columns <- c("life_expectancy", "log_gpd_pc", "no_water", "urban_population_percent")
plot(owid[,selected_columns])
cor(owid[,selected_columns])
```

Todas as variáveis explicativas possuem alta correção com a variável de resposta. `no_water` e `urban_population_percent` possuem alta correlação com `log_gpd_pc`, as `no_water` e `urban_population_percent` possuem correlação de (0.65) não tão alta quanto as demais, mas ainda significativo.

2. Para cada modelo, ajuste um modelo de regressão de 1a. ordem com as três variáveis explicativas consideradas. Discuta os resultados obtidos.

```{r}
# Modelo I
model1 <- lm(life_expectancy ~ birth_rate + expected_schooling + milk_consumption_pc, data = owid)

summary(model1)
```

Modelo: `Yhat = 72.778 - 0.499 * birth_rate + 0.672 * expected_schooling + 0.005247 * milk_consumption_pc`

R2 Multiplo: 0.8217

R2 Ajustado: 0.8212

Temos que o incluir as variáveis birth_rate, expected_schooling e milk_consumption_pc no modelo, reduz em cerca de 82,17% a variação total da variável resposta. O modelo ajustado possui um R2 ajustado de 82,12%, o que indica que o modelo é bom para explicar a variável resposta, além de que não há evidências de variáveis explicativas em "excesso" no modelo, pois o R2 ajustado é próximo do R2 múltiplo.

F-statistic:  1507 on 3 and 981 DF,  p-value: < 2.2e-16

O que indica que o modelo é bom para explicar a variável resposta, pois o p-valor é menor que 0.05. Isso indica que rejeitamos a hipótese nula de que os coeficientes são iguais a zero.

```{r}
# Modelo II

model2 <- lm(life_expectancy ~ log(gdp_pc) + no_water + urban_population_percent, data = owid)

summary(model2)
```

Modelo: `Yhat = 30.826 + 4.553 * log(gdp_pc) - 0.1846 * no_water + 0.00312 * urban_population_percent`

R2 Multiplo: 0.8023

R2 Ajustado: 0.8017

Temos que: incluir as variáveis log(gdp_pc), no_water e urban_population_percent no modelo, reduz em cerca de 80,23% a variação total da variável resposta. O modelo ajustado possui um R2 ajustado de 80,17%, o que indica que o modelo é bom para explicar a variável resposta, além de que não há evidências de variáveis explicativas em "excesso" no modelo, pois o R2 ajustado é próximo do R2 múltiplo.

F-statistic:  1327 on 3 and 981 DF,  p-value: < 2.2e-16

O que indica que o modelo é bom para explicar a variável resposta, pois o p-valor é menor que 0.05. Isso indica que rejeitamos a hipótese nula de que os coeficientes são iguais a zero.

3. Realize o diagnóstico dos modelos. É possível identificar um modelo que seja mais adequado aos dados?

O diagnóstico dos modelos é realizado através da análise dos resíduos:

Modelo I:
```{r}
#| layout-ncol: 2

# Constrói tabela com dados do modelo I
m1_data <- owid %>%
  # inclui coluna com valores ajustados
  mutate(fitted = m1$fit) %>%
  mutate(resid = m1$res)

# Gera gráficos dos resíduos:
# Grafico: resid x resposta ajustada (yhat)
ggplot(m1_data, aes(x = fitted, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("Gráfico de resíduos: modelo I") +
  labs(y = "resíduos", x = "resposta ajustada (life_expectancy)")

# Grafico: |resid| x resposta ajustada (yhat)
ggplot(m1_data, aes(x = fitted, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("Gráfico de resíduos absolutos: modelo I") +
  labs(y = "|resíduos|", x = "resposta ajustada (life_expectancy)")

```

Modelo II:

```{r}
#| layout-ncol: 2

# Constrói tabela com dados do modelo I
m2_data <- owid %>%
  # inclui coluna com valores ajustados
  mutate(fitted = m2$fit) %>%
  mutate(resid = m2$res)

# Gera gráficos dos resíduos:
# Grafico: resid x resposta ajustada (yhat)
ggplot(m2_data, aes(x = fitted, y = resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("Gráfico de resíduos: modelo II") +
  labs(y = "resíduos", x = "resposta ajustada (life_expectancy)")

# Grafico: |resid| x resposta ajustada (yhat)
ggplot(m2_data, aes(x = fitted, y = abs(resid))) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("Gráfico de resíduos absolutos: modelo II") +
  labs(y = "|resíduos|", x = "resposta ajustada (life_expectancy)")

```

Gráfico dos quartis modelo I:
```{r}
#| layout-ncol: 2
#| 
# Gráfico de quantis (para resíduos)
ggplot(m1_data, aes(sample = resid)) +
  stat_qq() + stat_qq_line() +
  labs(y = "quantis amostrais", x = "quantis teóricos (dist. normal)") +
  ggtitle("Gráfico de quantis (resíduos)")

# Gráfico de quantis (para resíduos semi-studentizados)
ggplot(m1_data, aes(sample = resid/sd(resid))) +
  stat_qq() + stat_qq_line() +
  labs(y = "quantis amostrais", x = "quantis teóricos (dist. normal)") +
  ggtitle("Gráfico de quantis (resíduos padronizados)")

```

Gráfico dos quartis modelo II:
```{r}
#| layout-ncol: 2
#| 
# Gráfico de quantis (para resíduos)
ggplot(m2_data, aes(sample = resid)) +
  stat_qq() + stat_qq_line() +
  labs(y = "quantis amostrais", x = "quantis teóricos (dist. normal)") +
  ggtitle("Gráfico de quantis (resíduos)")

# Gráfico de quantis (para resíduos semi-studentizados)
ggplot(m2_data, aes(sample = resid/sd(resid))) +
  stat_qq() + stat_qq_line() +
  labs(y = "quantis amostrais", x = "quantis teóricos (dist. normal)") +
  ggtitle("Gráfico de quantis (resíduos padronizados)")

```

Podemos  perceber principalmente no gráfico de quartis que o modelo II possui um maior afastamento da normalidade dos resíduos que o modelo I. Isso indica que o modelo I é mais adequado aos dados.

4. Para cada nível da variável `continent`, construa um modelo de regressão de 1a. ordem para `life_expectancy` como função das variáveis explicativas de um dos modelos acima (`birth_rate`, `expected_schooling` e `milk_consumption_pc` ou `log(gdp_pc)`, `no_water` e `urban_population_percent`).

  + Comente sobre os resultados obtidos para os modelos ajustados.  
  + As funções de regressão estimadas são semelhantes para os diferentes níveis da variável `continent`? Discuta.  
  + Analise os valores de MSE e $R^2_{aj}$ para cada modelo. Essas medidas são semelhantes para os diferentes níveis de `continent`?   Discuta.   
  + Realize o diagnóstico dos modelos construídos. Interprete os gráficos e os resultados obtidos.


### PARTE 3: Construção de Modelos

Utilize o procedimento para construir modelos de regressão para a resposta expectativa de vida (`life_expectancy`), considerando um dos conjuntos de variáveis explicativas: 

**Conjunto I:** `continent`, `birth_rate`, `expected_schooling` e `milk_consumption_pc` (e/ou transformações) 
**Conjunto II:** `continent`m `gdp_pc`, `no_water` e `urban_population_percent` (e/ou transformações)

Considere apenas o ano de 2015 e exclua o continente 'Oceania'.

Lembre-se que os passos apropriados em análise de regressão consistem em:

**construção do modelo**

+ formulação e ajuste do modelo  

Devemos utilizar o seguinte procedimento:

1. inclusão de termos contendo as variáveis quantitativas (polinomiais, transformações, interações, etc.);
2. inclusão de variáveis qualitativas e suas interações;
3. inclusão de interações entre termos contendo variáveis quantitativas e qualitativas;

**avaliação do modelo**

+ realizar análise de resíduos (verificar validade das hipóteses)

**utilização do modelo**

+ para realizar inferências
+ para auxiliar o processo de tomada de decisão

Forneça interpretações e discussão para os resultados obtidos.


----
